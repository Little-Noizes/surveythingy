<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.8">
    <title>Audio Reverb Assessment Survey</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .status-message {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: 600;
        }
        .success {
            background: rgba(40, 167, 69, 0.1);
            border: 2px solid rgba(40, 167, 69, 0.3);
            color: #155724;
        }
        .error {
            background: rgba(220, 53, 69, 0.1);
            border: 2px solid rgba(220, 53, 69, 0.3);
            color: #721c24;
        }
    </style>
    <script>
        class AudioReverbSurvey {
            constructor() {
                this.googleSheetURL = 'YOUR_GOOGLE_SHEETS_URL_HERE';
                this.audioFiles = {
                    'Speech': {
                        'Anechoic': 'spoken_dry2.wav',
                        'No effect (Tmid 0.3s)': 'spoken_small2.wav',
                        'Digital Reverb 1 (Tmid 1.3s)': 'spoken_medium2.wav',
                        'Digital Reverb 2 (Tmid 1.5s)': 'spoken_large2.wav'
                    },
                    'Jazz music': {
                        'Anechoic': 'melodic_dry.wav',
                        'No effect (Tmid 0.3s)': 'melodic_small.wav',
                        'Digital Reverb 1 (Tmid 1.3s)': 'melodic_medium.wav',
                        'Digital Reverb 2 (Tmid 1.5s)': 'melodic_large.wav'
                    }
                };

                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', () => this.initialize());
                } else {
                    this.initialize();
                }
            }

            initialize() {
                this.form = document.getElementById('survey-form');
                this.audioPlayer = document.getElementById('audio-player');
                this.soundType = document.getElementById('sound-type');
                this.roomType = document.getElementById('room-type');
                this.statusDiv = document.getElementById('status-message');
                this.playButton = document.getElementById('play-button');
                this.stopButton = document.getElementById('stop-button');

                this.setupEventListeners();
                this.updateAudioSource();
            }

            setupEventListeners() {
                this.form.addEventListener('submit', (e) => this.submitSurvey(e));
                this.soundType.addEventListener('change', () => this.updateAudioSource());
                this.roomType.addEventListener('change', () => this.updateAudioSource());
                this.playButton.addEventListener('click', () => this.playCurrentAudio());
                this.stopButton.addEventListener('click', () => this.stopAudio());
            }

            updateAudioSource() {
                const soundType = this.soundType.value;
                const roomType = this.roomType.value;
                const audioFile = this.audioFiles[soundType][roomType];

                if (audioFile) {
                    this.audioPlayer.src = audioFile;
                    this.audioPlayer.load();
                    this.showMessage(`Loading ${soundType} - ${roomType}...`, 'info');
                } else {
                    this.showMessage('Audio file not found.', 'error');
                }
            }

            playCurrentAudio() {
                if (!this.audioPlayer.src) {
                    this.showMessage('No audio file selected.', 'warning');
                    return;
                }
                this.audioPlayer.play();
            }

            stopAudio() {
                this.audioPlayer.pause();
                this.audioPlayer.currentTime = 0;
            }

            submitSurvey(event) {
                event.preventDefault();

                const surveyData = {
                    participant_id: Math.floor(Math.random() * 1000000).toString(),
                    timestamp: new Date().toISOString(),
                    demographics: {
                        age: document.getElementById("age").value,
                        gender: document.getElementById("gender").value,
                        experience: document.getElementById("experience").value
                    },
                    assessment: {
                        sound_type: document.getElementById("sound-type").value,
                        room_type: document.getElementById("room-type").value,
                        responses: {
                            realism: parseInt(document.getElementById("realism").value),
                            naturalness: parseInt(document.getElementById("naturalness").value),
                            room_match: parseInt(document.getElementById("room-match").value),
                            pleasantness: parseInt(document.getElementById("pleasantness").value),
                            room_size: parseInt(document.getElementById("room-size").value),
                            suitability: parseInt(document.getElementById("suitability").value),
                            digital_processing: document.getElementById("digital-processing").value
                        }
                    }
                };

                this.submitToGoogleSheets(surveyData);
            }

            async submitToGoogleSheets(surveyData) {
                try {
                    await fetch(this.googleSheetURL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(surveyData),
                        mode: 'no-cors'
                    });

                    this.showMessage('Survey submitted successfully!', 'success');
                } catch (error) {
                    console.error('Error submitting:', error);
                    this.showMessage('Submission failed. Try again.', 'error');
                }
            }

            showMessage(message, type) {
                this.statusDiv.className = `status-message ${type}`;
                this.statusDiv.innerHTML = message;
                this.statusDiv.style.display = 'block';
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            window.survey = new AudioReverbSurvey();
        });
    </script>
</head>
<body>
    <div class="container">
        <h1>ðŸŽµ Audio Reverb Assessment Survey</h1>
        <div id="status-message" class="status-message" style="display: none;"></div>
        <form id="survey-form">
            <fieldset>
                <legend>ðŸ‘¤ Participant Demographics</legend>
                <label for="age">Age Group:</label>
                <select id="age" required>
                    <option value="">Select age group</option>
                    <option value="18-24">18-24</option>
                    <option value="25-34">25-34</option>
                </select>
            </fieldset>
            <button type="submit">Submit Survey</button>
        </form>
    </div>
</body>
</html>
